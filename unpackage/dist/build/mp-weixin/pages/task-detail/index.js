(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/task-detail/index"],{"73b6":function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a}));var a={uNavbar:function(){return n.e("uview-ui/components/u-navbar/u-navbar").then(n.bind(null,"11b1"))},uSteps:function(){return n.e("uview-ui/components/u-steps/u-steps").then(n.bind(null,"73d2"))},nnkjcDetailGroup:function(){return n.e("components/nnkjc-detail-group/nnkjc-detail-group").then(n.bind(null,"138a"))},nnkjcDetailItem:function(){return n.e("components/nnkjc-detail-item/nnkjc-detail-item").then(n.bind(null,"560a"))},uButton:function(){return n.e("uview-ui/components/u-button/u-button").then(n.bind(null,"5231"))},uEmpty:function(){return n.e("uview-ui/components/u-empty/u-empty").then(n.bind(null,"2385"))},uModal:function(){return n.e("uview-ui/components/u-modal/u-modal").then(n.bind(null,"d215"))},uSelect:function(){return n.e("uview-ui/components/u-select/u-select").then(n.bind(null,"d67a"))},uToast:function(){return n.e("uview-ui/components/u-toast/u-toast").then(n.bind(null,"0f55"))}},s=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){t.showModal=!0},t.e1=function(e){return t.$u.debounce(t.delegatePerson,500)},t.e2=function(e){return t.$u.debounce(t.confirmCalcel,500)})},i=[]},"8ada":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={name:"task-detail",data:function(){return{personIdIndexMap:{},showPerson:!1,personDefaultV:[0],personList:[],showBtn1:!1,showBtn2:!1,showBtn3:!1,showModal:!1,loading:!1,empty:!1,detail:{seqNo:"",createTime:"",updateTime:"",statusText:""},background:{background:"#f2f2f8"},current:0,numList:[{name:"新建"},{name:"委派"},{name:"维修"},{name:"检定"}],searchParams:{id:"",type:"",status:""}}},computed:{PREMISS:function(){return this.$store.state.PREMISS}},onLoad:function(t){this.searchParams.id=t.taskId,this.searchParams.status=t.status,this.searchParams.type=t.type},onReady:function(){this.getDetail()},onShow:function(){this.getPersons()},methods:{getPersons:function(){var t=this;this.$u.post("/sys/staff/getStaffListForWexiu").then((function(e){e.data&&(t.personList=e.data.map((function(e,n){return t.personIdIndexMap[e.id]=n,{value:e.id,label:e.staffName}})))})).catch((function(t){}))},personConfirm:function(e){var n=this;this.personDefaultV=[this.personIdIndexMap[e[0].value]||0],this.loading=!0,this.$u.post("maint/saveSend",{taskId:this.searchParams.id,maintStaffIds:e[0].value,type:this.searchParams.type}).then((function(e){200===e.code&&(n.$refs.uToast.show({title:"委派成功",type:"success"}),setTimeout((function(){t.reLaunch({url:"/pages/home/index"})}),500))})).catch((function(t){})).finally((function(t){n.showPerson=!1,n.loading=!1}))},personCancel:function(){this.showPerson=!1},back:function(){t.navigateBack({delta:1})},modifyReason:function(){var e=this.$u.queryParams({taskId:this.detail.id,status:this.searchParams.status,type:this.searchParams.type});t.navigateTo({url:"/pages/home/modify-task/modify-task"+e})},confirmCalcel:function(){var e=this;this.$u.post("/maint/delTask",{id:this.detail.id}).then((function(n){200===n.code&&(e.$store.commit("freshTaskFunc",!0),t.reLaunch({url:"/pages/home/index"}))})).catch((function(t){}))},foMaintProcess:function(){var e=this.$u.queryParams({taskId:this.searchParams.id});t.navigateTo({url:"/pages/maint-process/index"+e})},getDetail:function(){var e=this;this.$u.post("/maint/getWeixiuTaskDetail",this.searchParams).then((function(n){if(n.data){var a=t.getStorageSync("user"),s=t.getStorageSync("premissObj");if(e.detail=n.data,e.detail){var i=a&&a.staffId===e.detail.createStaffId,u="10"==e.searchParams.status;e.showBtn1=!!(u&&s&&s[e.PREMISS.modifyreason]&&i),e.showBtn2=!!(u&&s&&s[e.PREMISS.delitem]&&i),e.showBtn3=!!(u&&s&&s[e.PREMISS.delegate]);var o=[{"表单状态":e.detail.status,"表单 mstaffId":e.detail.maintStaffId,"用户 staffId":a.staffId,"表单类型":e.detail.type,"修改权限":s[e.PREMISS.modifyreason],"取消权限":s[e.PREMISS.delitem],"委派权限":s[e.PREMISS.delegate],"重新委派权限":s[e.PREMISS.reDelegate],"接单权限":s[e.PREMISS.reveive],"拒单权限":s[e.PREMISS.refuse]}];console.table(o)}}else e.empty=!0})).catch((function(t){}))},delegatePerson:function(){this.showPerson=!0}}};e.default=n}).call(this,n("543d")["default"])},"8c4b":function(t,e,n){"use strict";var a=n("a739"),s=n.n(a);s.a},a579:function(t,e,n){"use strict";(function(t){n("5d15");a(n("66fd"));var e=a(n("e86e"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},a739:function(t,e,n){},e86e:function(t,e,n){"use strict";n.r(e);var a=n("73b6"),s=n("ea38");for(var i in s)"default"!==i&&function(t){n.d(e,t,(function(){return s[t]}))}(i);n("8c4b");var u,o=n("f0c5"),r=Object(o["a"])(s["default"],a["b"],a["c"],!1,null,"7811bca6",null,!1,a["a"],u);e["default"]=r.exports},ea38:function(t,e,n){"use strict";n.r(e);var a=n("8ada"),s=n.n(a);for(var i in a)"default"!==i&&function(t){n.d(e,t,(function(){return a[t]}))}(i);e["default"]=s.a}},[["a579","common/runtime","common/vendor"]]]);